<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      lang="en"
      layout:decorator="fragments/layout">
<head>
    <link th:insert="Account/AccScriptLink"/>
    <!--<link th:href="@{/css/easyAutocomplete/easy-autocomplete.min.css}" rel="stylesheet"/>-->

    <!--<script th:src="@{/js/easyAutocomplete/autocomplete.js}"></script>-->
    <!--<script th:src="@{/js/easyAutocomplete/jquery.easy-autocomplete.min.js}"></script>-->
    <script >


        var totDr=0;
        var totCr=0;

function al()
{
    alert('xx');
}
        function accsourcvalidation() {
            $("#inputsourcempty").val(0);
            $("#sourcemptysubaccind").val('');
            $("#sourcemptycolorind").val('');
            var a=0;
            $('.inputsourceid').each(function () {
                varvSource=null;
                var varvSource = document.getElementById('idl' +a).value;
                if (varvSource=='NONE') {
                    a = a + 1;  ///// if condition true the loop increment
                }
                else if (varvSource=='SUBACC')
                {
                    var sourcIdd = null;
                    var sourcIdd = $('#sAsid' + a).val();
                    document.getElementById('sAsName' + a).style.borderColor = "#CCC";
                    if (sourcIdd == '') {
                        alert('Source SubAcc Is Not Valid');
                        $("#inputsourcempty").val(1);
                        $("#sourcemptysubaccind").val(a);
                        a = a + 1;
                    }
                    else {
                        a = a + 1;
                    }}
                else {
                    var sourcIdd = null;
                    var sourcIdd = $('#sourceId' + a).val();
                    document.getElementById('sourceName' + a).style.borderColor = "#CCC";
                    if (sourcIdd == '') {
                        alert('Source Is Not Valid');
                        $("#inputsourcempty").val(1);
                        $("#sourcemptycolorind").val(a);
                        a = a + 1;
                    }
                    else {
                        a = a + 1;
                    }
                }
            })
            var yy= document.getElementById('inputsourcempty').value;
            var zz= document.getElementById('sourcemptycolorind').value;
            var xx= document.getElementById('sourcemptysubaccind').value;

            document.getElementById('sourceName'+zz).style.borderColor = "#CCC";

            if (yy== 1) {
                if (zz!=='') {
                    document.getElementById('sourceName' + zz).style.borderColor = "red";
                    return false;
                } else{
                    document.getElementById('sAsName' + xx).style.borderColor = "red";
                    return false;
                }
            }
            else {
                document.getElementById('sourceName'+zz).style.borderColor = "#CCC";
                document.getElementById('sAsName'+xx).style.borderColor = "#CCC";
                return true;
            }};

        function selectedobj(value, ind, pId) {
            if (ind == 'codecombination') {
                sourcedobj(value, pId);
            }
            else if (ind == 'source') {
                sourcedobjSource(value, pId);
            } else if (ind == 'subAccSource') {
                sourcedobjSubAccSource(value, pId);
            } else if (ind == 'subAccSourceDataSet') {
                sourcedobjSubAccSourceNone(value, pId);
            } else
            if(ind=='seg1AccGl')
            {
                AccGlSearchseg1(value);
            }
            else if(ind=='seg2AccGl')
            {
                AccGlSearchseg2(value);
            }
            else if(ind=='seg3AccGl')
            {
                AccGlSearchseg3(value);
            }
            else if(ind=='seg4AccGl')
            {
                AccGlSearchseg4(value);
            }
            else if(ind=='seg5AccGl')
            {
                AccGlSearchseg5(value);
            }
            else if(ind=='seg6AccGl')
            {
                AccGlSearchseg6(value);
            }
            else if(ind=='seg7AccGl')
            {
                AccGlSearchseg7(value);
            }
            else if(ind=='seg8AccGl')
            {
                AccGlSearchseg8(value);
            }
        };

        function fieldvisivlity(pfieldindex)
        {
            var vSource = document.getElementById('idl' +pfieldindex).value;
            var sourceDiv = pfieldindex + 'div2';
            var subAccDiv = pfieldindex + 'div3';
            if (vSource == 'NONE') {
                document.getElementById(sourceDiv).style.display = 'none';
                document.getElementById(subAccDiv).style.display = 'none';
            }else if (vSource == 'SUBACC') {
                document.getElementById(sourceDiv).style.display = 'none';
                document.getElementById(subAccDiv).style.display = 'block';
            }

            else if (vSource == '') {
                document.getElementById(sourceDiv).style.display = 'none';
                document.getElementById(subAccDiv).style.display = 'none';
            }
            else {
                document.getElementById(sourceDiv).style.display = 'block';
                document.getElementById(subAccDiv).style.display = 'none';
            }}

        function getmodatbtnid(xx){
            var yy=xx;
            document.getElementById('uu').value=yy ;
        };

        function sourcedobj(objparms, ppId) {
            var lpId=ppId;
            var objparmV = objparms;
            var dbfield = '#id' + lpId;
            var dbfield1 = '#idl' +lpId;
            var lSource= '#source' +lpId;
            var dbsAsNtVal = '#sAsNtVal' +lpId;
            var idVal =objparmV.id;
            $(dbfield).val(idVal).trigger("change");
            $(dbfield1).val(objparmV.source).trigger("change");
            $(lSource).val(objparmV.source).trigger("change");
            $(dbsAsNtVal).val(objparmV.sourceTypeNoneTypeVal).trigger("change");
            $(dbfield).change(function () {
                var vSource = document.getElementById('idl' +lpId).value;
                var sourceDiv = lpId + 'div2';
                var subAccDiv = lpId + 'div3';
                if (vSource == 'NONE') {
                    document.getElementById(sourceDiv).style.display = 'none';
                    document.getElementById('sourceId'+lpId).value = '';
                    document.getElementById('sourceName'+lpId).value = '';
                    document.getElementById(subAccDiv).style.display = 'none';
                    document.getElementById('sAsName'+lpId).value = '';
                    document.getElementById('sAsid'+lpId).value = '';
                    document.getElementById('sAs'+lpId).value = '';
                    document.getElementById('dataSet'+lpId).value = '';
                }else if (vSource == 'SUBACC') {
                    document.getElementById(sourceDiv).style.display = 'none';
                    document.getElementById('sourceId'+lpId).value = '';
                    document.getElementById('sourceName'+lpId).value = '';
                    document.getElementById(subAccDiv).style.display = 'block';
                    document.getElementById('sAsName'+lpId).value = '';
                    document.getElementById('sAsid'+lpId).value = '';
                    document.getElementById('sAs'+lpId).value = '';
                    document.getElementById('dataSet'+lpId).value = '';
                }
                else {
                    document.getElementById(sourceDiv).style.display = 'block';
                    document.getElementById(subAccDiv).style.display = 'none';
                    document.getElementById('sAsName'+lpId).value = '';
                    document.getElementById('sAsid'+lpId).value = '';
                    document.getElementById('sAs'+lpId).value = '';
                    document.getElementById('dataSet'+lpId).value = '';
                }
            });
        };

        function validate(pAccDesc, pl_accId, pId) {
            var lSource = document.getElementById('source').value;
            var keySegId = [[${orgHierarchy.keySegmentHeader.id}]];
            var lBalSeg = [[${session.globalbalSeg}]];
//            alert(lBalSeg);
            var urlvals;
            var getvalues;
            var re = /^[A-Za-z]+$/;
            if (pAccDesc.length > 1) {
                if (re.test(pAccDesc)) {
                    urlvals = '/AYE/ACRC/SearchCodeCombDescBySource/' + pAccDesc + '/' + keySegId + '/'+lBalSeg+ '/'+lSource+ '/'+1;
                    getvalues = 'ccDesc';
                    ltemplate ='concatedSegment';
                    AutoComAcc(urlvals, getvalues, ltemplate, pId);
                } else {
                        urlvals = '/AYE/ACRC/SearchCodeCombDescBySource/' + pAccDesc + '/' + keySegId + '/'+lBalSeg+ '/'+lSource+ '/'+0;
                    getvalues = 'concatedSegment';
                    ltemplate ='ccDesc';
                    AutoComAcc(urlvals, getvalues, ltemplate, pId);
                }
            }
        };

        function AutoComAcc(pUrl, pgetvalues, ptemplates, indId) {
            var indIdV = indId;
            var urlvals = pUrl;
            var displayfields = '#val' + indIdV;
            var dbfield = '#id' + indIdV;
            var getvalues = pgetvalues;
            var templates = ptemplates;
            var indc = 'codecombination';
            autocomwithobject(urlvals, getvalues, displayfields, dbfield, templates, indc,indIdV);
        };
//======================
        function sourcedobjSource(objparms, pId) {
            var objparmV = objparms;
            var dbfield = '#sourceId' + pId;
            var vwfield = '#sourceName' + pId;
            $(dbfield).val(objparmV.id).trigger("change");
            $(vwfield).val(objparmV.name).trigger("change");
        };


        function sourcedobjSubAccSource(objparms, pId) {
            var objparmV = objparms;
            var subAccSourceId = '#sAsid' + pId;
            var dbfield2 = '#sAs' + pId;
            $(subAccSourceId).val(objparmV.id).trigger("change");
            $(dbfield2).val(objparmV.accCodeCombinitions.accountSource).trigger("change");
        }
        ;

        function sourcedobjSubAccSourceNone(objparms, pId) {
            var objparmV = objparms;
            var subAccSourceId = '#sAsid' + pId;
            var dataSetId = '#dataSet' + pId;
            $(subAccSourceId).val(objparmV.id).trigger("change");
            $(dataSetId).val(objparmV.dataSet.id).trigger("change");

        };

        function getcodcomfmodal(pcode,pid,pSource,pSrtNonValT){
            var iv=document.getElementById('uu').value
            var sId = 'idl' +iv;
            document.getElementById('val' +iv).value=pcode;
            document.getElementById('id' +iv).value=pid;
            document.getElementById('idl' +iv).value=pSource;
            document.getElementById('sAsNtVal'+iv).value = pSrtNonValT;
            var sourceDiv = iv + 'div2';
            var subAccDiv = iv + 'div3';

            if (pSource == 'NONE') {
                document.getElementById(sourceDiv).style.display = 'none';
                document.getElementById('sourceId'+iv).value = '';
                document.getElementById('sourceName'+iv).value = '';
                document.getElementById(subAccDiv).style.display = 'none';
                document.getElementById('sAsName'+iv).value = '';
                document.getElementById('sAsid'+iv).value = '';
                document.getElementById('sAs'+iv).value = '';
                document.getElementById('dataSet'+iv).value = '';
            }else if (pSource == 'SUBACC') {
                document.getElementById(sourceDiv).style.display = 'none';
                document.getElementById('sourceId'+iv).value = '';
                document.getElementById('sourceName'+iv).value = '';
                document.getElementById(subAccDiv).style.display = 'block';
                document.getElementById('sAsName'+iv).value = '';
                document.getElementById('sAsid'+iv).value = '';
                document.getElementById('sAs'+iv).value = '';
                document.getElementById('dataSet'+iv).value = '';
            }
            else {
                document.getElementById(sourceDiv).style.display = 'block';
                document.getElementById(subAccDiv).style.display = 'none';
                document.getElementById('sAsName'+iv).value = '';
                document.getElementById('sAsid'+iv).value = '';
                document.getElementById('sAs'+iv).value = '';
                document.getElementById('dataSet'+iv).value = '';
            }
            $('#modal-warning').modal('hide');
        };


        function getSource(psId) {
            var lpsId=psId;
            var gsourceName = document.getElementById('sourceName' +lpsId).value;
            if (gsourceName.length > 1) {
                sourceAutocom(gsourceName, lpsId);
                document.getElementById('sourceName' +lpsId).focus();
            }
        }

        function getSubaccSource(psId) {
            var lpsId=psId;
            var gsourceName = document.getElementById('sAsName' +lpsId).value;
            if (gsourceName.length > 1) {
                sourceAutocom(gsourceName, lpsId);
                document.getElementById('sAsName' +lpsId).focus();
            }
        }

        function sourceAutocom(sourceName, psId) {
            var psIdv=psId;
            var orgId = [[${orgHierarchy.id}]];
            var tmplDtId = [[${temltId}]];
            var src = document.getElementById('idl' +psIdv).value;
            var vAccId = document.getElementById('id' +psIdv).value;

            if (src=='SUBACC')
            {
                var vSrtNonValT = document.getElementById('sAsNtVal' +psIdv).value;
                var urlval = '/AYE/ACRC/SearchSubAccSource/' + vAccId+ '/' + orgId + '/' + sourceName+'/'+tmplDtId;
                var displayfields = '#sAsName' + psIdv;
                var dbfields = '#sAsid' + psIdv;
                var getvalues = 'name';
                var indc = 'subAccSource';

                var templates = 'siteAddress';
                if(vSrtNonValT=='DATASET')
                {
                    getvalues = 'value';
                    indc ='subAccSourceDataSet'
                    templates ='';
                }
                autocomwithobject(urlval, getvalues, displayfields, dbfields, templates, indc,psIdv);
            }else
            {
                var urlval = '/AYE/ACRC/SearchSource/'+ vAccId+ '/' +  src + '/' + orgId + '/' + sourceName;
                var displayfields = '#sourceName' + psIdv;
                var dbfields = '#sourceId' + psIdv;
                var getvalues = 'name';
                var templates = 'siteAddress';
                if(src=='CM')
                {
                    templates = 'accountNumber';
                }
                var indc = 'source';

                autocomwithobject(urlval, getvalues, displayfields, dbfields, templates, indc,psIdv);
            }
        };


        function glPostBtnVsblty()
        {var pLidC = 0;
            var cLineId;
            $('.combatLineId').each(function () {
                cLineId = parseFloat(this.value);
//                alert(cLineId);
                if (isNaN(parseFloat(cLineId))||cLineId==0)
                {
                    pLidC=pLidC+1;
                }
            });


            var res ;
            if (totDr!=0||totCr!=0)
            {
                res =totDr-totCr;
//                alert(totDr+" "+totCr+" "+res)


                if (res !=0)
                {   $('.isBalanced').html('<b>'+"Not Balanced"+'</b>');
                    $('.isBalanced').css({ 'color': 'red'});
                    pLidC=pLidC+1;
                }else
                {
                    $('.isBalanced').html('<b>'+"  Balanced"+'</b>');
                    $('.isBalanced').css({ 'color': 'green'});
//                $('.postbtn').prop("disabled",false);
//                document.getElementById('postbtn').disabled = false;
                }

            }else
            {
                pLidC=pLidC+1;
            }


            var lStatus=document.getElementById('inputstatus').value;
            if(lStatus!='N')
            {
                pLidC=pLidC+1;
            }


            if (pLidC==0)
            {
                $('#postbtn').prop("disabled",false);
            }else
            {
                $('#postbtn').prop("disabled",true);
            }

        }

        function setDrBaseAmt(element)
        {
            var baseDr="#baseamtdr"+element.id;
            var lDrAmt=element.value;
            var execRate = document.getElementById('inputexchRate').value;
            var l =lDrAmt*execRate;
            $(baseDr).val(l);

        }
        function setCrBaseAmt(element)
        {
            var baseDr="#baseamtcr"+element.id;
            var lDrAmt=element.value;
            var execRate = document.getElementById('inputexchRate').value;
            var l =lDrAmt*execRate;
            $(baseDr).val(l);
            return true;

        }
        function totDrAmountGl(pEle) {
            if (pEle!=null||pEle!="")
            {
                setDrBaseAmt(pEle);

            }
            totDrAmountGlM();
        }
        function totDrAmountGlM() {


                var sumdr = 0;
                var amtdr
                $('.combatdr').each(function () {
//                    document.getElementById('amtdr').val
                    //amt = isNaN(parseFloat(this.value))
                    amtdr = parseFloat(this.value);
                    if (isNaN(parseFloat(amtdr)))
                    {
                        amtdr=0;
                    }
                    sumdr=sumdr+amtdr;
//                    alert(amtdr+" "+sumdr.toFixed(2));

                    totDr =sumdr;

                });
                totDr = sumdr.toFixed(2);
//            alert(totDr);
                $('.total-combatdr').html('<b>'+totDr+'</b>');
            glPostBtnVsblty();
            };

        function totCrAmountGl(pEle) {
            if (pEle != null || pEle != "") {
                setCrBaseAmt(pEle);
            }
            totCrAmountGlM();
        }

            function totCrAmountGlM() {

                var sumcr = 0;
            var amtcr
            $('.combatcr').each(function () {
//                alert('ddd')
                //amt = isNaN(parseFloat(this.value))
                amtcr = parseFloat(this.value);
                if (isNaN(parseFloat(amtcr))) {
                    amtcr = 0;
                }
                sumcr = sumcr + amtcr;
            });
            totCr = sumcr.toFixed(2);
            $('.total-combatcr').html('<b>' + totCr + '</b>');
            glPostBtnVsblty();
        }

        function multipleFuncCall(param1)
        {
            accsourcvalidation();
            prevDbClick(param1);
        }
    </script>

</head>
<body>
<div class="right_col" role="main" data-layout-fragment="content">
    <div class="row">
        <div class="col-sm-11 ">
            <!--<div class="container">-->
            <div class="panel panel-default">
                <!-- Default panel contents -->
                <div class="form-group col-sm-12  jepg_cust_head">
                    <div class="form-group col-sm-5 " style="padding-left: 0; color: #172D44">Journal Entry </div>
                    <div class="form-group col-sm-7 text-right Padding10px" style=" font-size: 12px;" align="right">
                        <input type="hidden" id="inputsourcempty"/>
                        <input type="hidden" id="sourcemptycolorind"/>
                        <input type="hidden" id="sourcemptysubaccind"
                               />
                        <form th:action="@{'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}}"
                              th:method="post" th:target="_blank"
                              th:if="${glHeader.status!=T(com.aye.web.model.common.GlStatus).N}">
                            <button target="_blank" type="submit" name="rpt"
                                    th:value="'Journal_voucher :'+${glHeader.id}" class="btn btn-primary"
                                    align="center">
                                <span class="glyphicon glyphicon-print"></span> Print

                            </button>

                        </form>
                    </div>
                </div>
                <div class="panel-body">

                   <form action="'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}"
                          th:action="@{'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}}"
                          th:object="${glHeader}" th:method="post">

                        <span style="font-weight: bold" th:each="m :${msg}">
                            <p th:style="${m.tag} ? 'color:#ed1c24;':'color:#4aa509;'">
                                <span th:if="${m.tag==null}" th:text="${m.msg}"> </span>
                                <span th:unless="${m.tag==null}" th:text="${m.tag+' '+m.msg}"></span>
                            </p></span>
                       <div class="submit-progress hidden">
                           <label th:style="'color:#4aa509;'">Please wait while Saving Data...</label>
                       </div>
                        <div class="form-group">
                            <!--<label for="inputSegment1">Name</label>-->
                            <input type="hidden" class="form-control" id="inputid" placeholder="id"
                                   th:field="*{id}" name="id"/>
                            <span class="help-block" th:if="${#fields.hasErrors('id')}"
                                  th:errors="*{id}">Name Error</span>
                        </div>



                        <div class="form-group col-sm-12">
                            <div class="col-sm-1 ">
                                </div>


                            <label class="col-sm-2 control-label " for="inputdocumentNumber">Document Number</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-4 ">
                                <input class="form-control" type="text" id="inputdocumentNumber"
                                       th:field="*{documentNumber}" name="documentNumber" readonly="readonly"/>
                                <span class="help-block" th:if="${#fields.hasErrors('documentNumber')}"
                                      th:errors="*{documentNumber}">Name Error</span>
                            </div>

                            <div class="col-sm-3 ">
                                <input class="form-control" type="hidden" id="inputstatus"
                                       th:value="*{status}" th:field="*{status}" name="status"/>
                                <span class="help-block" th:if="${#fields.hasErrors('status')}"
                                      th:errors="*{status}">Status Error</span>
                            </div>

                            <div class="col-sm-3 ">
                                <input class="form-control" type="text" id="inputstatusDesc"
                                       th:field="${glHeader.status.displayName}" readonly="readonly"/>
                                <span class="help-block" th:if="${#fields.hasErrors('status')}"
                                      th:errors="*{status}">Status Error</span>
                            </div>

                            <div class="col-sm-1 ">
                            </div>

                        </div>

                        <div class="form-group required col-sm-12">
                            <div class="col-sm-1 ">
                            </div>

                            <label class="col-sm-2 control-label " for="inputcategory">Category</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>

                            <div class="col-sm-7 ">
                                <select class="form-control" required="required" type="text" id="inputcategory"
                                        th:field="*{category}" name="category"
                                        th:disabled="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}">
                                    <option th:if="${#lists.size(glCategories) gt 1 }" value="">Please select One
                                    </option>
                                    <option th:each="catagories : ${glCategories}"
                                            th:text="${catagories.categoriesCode}"
                                            th:value="${catagories.id}"
                                            th:attr="data-source=${catagories.accountSource}">module
                                    </option>
                                </select>

                                <div>
                                    <input type="hidden" id="source"
                                           th:field="*{category.accountSource}"
                                           class="form-control"/>
                                </div>
                                <span class="help-block" th:if="${#fields.hasErrors('category')}"
                                      th:errors="*{category}">Category Error</span>
                            </div>
                            <script th:inline="javascript">
                                $("#inputcategory").change(function () {
                                    var varSource = ($(this.options[this.selectedIndex]).attr('data-source'));
                                    $("#source").val(varSource);
                                });
                            </script>

                            <div class="col-sm-1 ">
                            </div>

                        </div>


                        <div class="form-group required col-sm-12">
                            <div class="col-sm-1 ">
                            </div>
                            <label class="col-sm-2 control-label " for="inputcurrency">Currency</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-7 " id="inputcurrencyLoc">
                                <input type="text"  class="form-control" id="inputcurrency2nd"  th:field="*{currency.code}" th:value="*{currency}" readonly/>
                            </div>
                            <div class="col-sm-7 " id="inputcurrencyEnt">
                                <select class="form-control" name="currency" id="inputcurrency" required="required"
                                        th:disabled="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}">
                                    <!--<option value="">Please select One</option>-->
                                    <option th:each="cur : ${currency}" th:value="${cur.id}" th:text="${cur.code}"
                                            th:field="*{currency}"
                                            th:attr="data-defExec=${cur.defaultExcgangeRate}">
                                    </option>
                                </select>
                                <script th:inline="javascript">
                                    var ldefCur = [[${defCurrency}]];
                                    $("#inputcurrency").change(function () {
                                        var locCurVal = ldefCur.code;

                                        var varDefexecRate = ($(this.options[this.selectedIndex]).attr('data-defExec'));
                                        var varSelectdexec = ($(this.options[this.selectedIndex]).text());
//                                        alert(varDefexecRate);
                                        document.getElementById('inputcurrencyCode').value = varSelectdexec;
                                        document.getElementById('inputcurrencyLoc').value = varSelectdexec;
                                        document.getElementById('inputexchRate').value = varDefexecRate;
                                        document.getElementById('inputcurrency2nd').value= varSelectdexec;
                                        if (varSelectdexec == locCurVal) {
                                            document.getElementById('inputexchRateDiv').style.display = 'none';
//                                            document.getElementById('inputexchdateDiv').style.display = 'none';
                                        } else {
                                            document.getElementById('inputexchRateDiv').style.display = 'block';
//                                            document.getElementById('inputexchdateDiv').style.display = 'block';
                                        }
                                    });
                                </script>

                                <input type="hidden" id="inputcurrencyCode" th:field="*{currencyCode}"/>
                                <span class="help-block" th:if="${#fields.hasErrors('currency')}"
                                      th:errors="*{currency}">Currency Error</span>
                            </div>
                            </div>
                       <div id="inputexchRateDiv" class="form-group required col-sm-12">
                           <div class="col-sm-1 ">
                           </div>

                           <label class="col-sm-2 control-label"> Exch Rate & Date </label>
                           <div class="col-sm-1 ">
                               <b>:</b>
                           </div>

                            <div class="col-sm-3 ">
                                    <input type="text" id="inputexchRate" placeholder="exchRate"
                                           name="exchRate" th:field="*{exchRate}" class="form-control" />

                                    <p th:errors="*{exchRate}" class="help-block"></p>

                                    <script th:inline="javascript">
                                        $(document).ready(function () {
                                            var localExec = document.getElementById('inputcurrency').value;
//                                            alert(localExec+" asd" );
                                            var localExecSel = document.getElementById('inputcurrency');
                                            var localExecSelVal =localExecSel.options[localExecSel.selectedIndex].text;
                                            document.getElementById('inputcurrency2nd').value= localExecSelVal;
                                            var locCurIdVal = ldefCur.id;
                                            var locCusrRate = ldefCur.defaultExcgangeRate;

//
                                            var lSize =[[${#lists.size(glHeader.glLinesList)}]];
                                            var lId =[[${glHeader.id}]];
//
//                                        alert(lSize);
                                            if (lSize>0 && lId!=null)
                                            {
                                                document.getElementById('inputcurrencyLoc').style.display='block' ;
                                                document.getElementById('inputcurrencyEnt').style.display='none' ;
                                                $('#inputexchRate').attr('readonly', true);
                                                $('#inputexchDate').attr('readonly', true);
                                            }else
                                            {
                                                document.getElementById('inputcurrencyLoc').style.display='none' ;
                                                document.getElementById('inputcurrencyEnt').style.display='block' ;
                                                $('#inputexchRate').attr('readonly', false);
                                                $('#inputexchDate').attr('readonly', false);
                                            }

                                            if (localExec == locCurIdVal) {
//                                            alert('Y'+' '+localExec+' '+locCurIdVal);

                                                document.getElementById('inputexchRateDiv').style.display = 'none';
//                                            document.getElementById('inputexchdateDiv').style.display = 'none';
                                                document.getElementById('inputcurrency2nd').value= localExecSelVal;
                                                document.getElementById('inputexchRate').value = locCusrRate;
                                            }else if (localExec==null||localExec=="")
                                            {
                                                document.getElementById('inputexchRateDiv').style.display = 'none';
                                            }
                                            else {
//                                            alert('N');
                                                document.getElementById('inputexchRateDiv').style.display = 'block';
//                                            document.getElementById('inputexchdateDiv').style.display = 'block';
                                            }
                                        })

                                    </script>



                                </div>

                                <div class="col-sm-4 ">
                                    <input type="date" id="inputexchDate" placeholder="exchDate"
                                           name="exchRate" th:field="*{exchDate}" class="form-control" />

                                    <script th:inline="javascript">
                                        var trns = [[*{documentNumber}]];
                                        var ldefCur2 = [[${defCurrency}]];
                                        if (trns != null) {
                                            var varLCurCode = document.getElementById('inputcurrencyCode').value;
                                            if (varLCurCode == ldefCur2) {
                                                document.getElementById('inputexchRateDiv').style.display = 'none';
//                                                document.getElementById('inputexchdateDiv').style.display = 'none';
                                            } else {
                                                document.getElementById('inputexchRateDiv').style.display = 'block';
//                                                document.getElementById('inputexchdateDiv').style.display = 'block';
                                            }


                                        }

                                    </script>

                                    <p th:errors="*{exchDate}" class="help-block"></p>

                                </div>
                            </div>


                        <div class="form-group required col-sm-12">
                            <div class="col-sm-1 ">
                            </div>
                            <label class="col-sm-2 control-label " for="inputcalendarDetail">Calendar</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>

                            <div class="col-sm-4  ">
                                <input class="form-control" type="date" value="01-01-2019" id="inputdate"
                                       th:field="*{{date}}"
                                       name="date"
                                       th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                <input type="hidden" id="modelAttr" name="modelAttr" th:value="${temltId}"/>


                                <script>


                                    $("#inputdate").change(function () {
                                        var date = $('#inputdate').val();
                                        $("#inputperiodName").val(moment(date).format('MMM-YY'));
                                    });

                                    $("#inputdate").ready(function () {
                                        var date = $('#inputdate').val();
                                        if (date != "") {
                                            $("#inputperiodName").val(moment(date).format('MMM-YY'));
                                        }});

                                </script>
                                <span class="help-block" th:if="${#fields.hasErrors('date')}"
                                      th:errors="*{date}">Date Error</span>
                            </div>

                            <div class="col-sm-3  ">
                                <input class="form-control" type="text" name="periodName" id="inputperiodName"
                                       th:field="*{periodName}" readonly="readonly"/>

                                <span class="help-block" th:if="${#fields.hasErrors('periodName')}"
                                      th:errors="*{periodName}">CalendarDetail Error</span>
                            </div>


                            <div class="col-sm-4  ">
                                <input class="form-control" type="hidden" name="calendarDetail" id="inputcalendarDetail"
                                       th:field="*{calendarDetail}"/>

                                <span class="help-block" th:if="${#fields.hasErrors('calendarDetail')}"
                                      th:errors="*{calendarDetail}">CalendarDetail Error</span>
                            </div>
                            <div class="col-sm-1 ">
                            </div>
                        </div>


                        <div>

                            <div>
                                <input type="hidden" name="appModule" id="appModule"
                                       th:value="${module.id}"/>
                                <span class="help-block" th:if="${#fields.hasErrors('appModule')}"
                                      th:errors="*{appModule}">appModule Error</span>
                            </div>
                        </div>

                        <div>

                            <div>
                                <input type="hidden" name="orgHierarchy" id="orgHierarchy"
                                       th:value="${orgHierarchy.id}"/>
                                <span class="help-block" th:if="${#fields.hasErrors('orgHierarchy')}"
                                      th:errors="*{orgHierarchy}">appModule Error</span>
                            </div>
                        </div>


                        <div class="form-group col-sm-12">
                            <div class="col-sm-1 ">
                            </div>
                            <label class="col-sm-2 control-label " for="inputdescription">Description</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-7 ">
                                <input class="form-control" type="text" id="inputdescription"
                                       th:field="*{description}" name="description"
                                       th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                <span class="help-block" th:if="${#fields.hasErrors('description')}"
                                      th:errors="*{description}">description Error</span>
                            </div>
                            <div class="col-sm-1 ">
                            </div>
                        </div>

                        <div class="form-group col-sm-12">
                            <div class="col-sm-1 ">
                            </div>
                            <label class="col-sm-2 control-label " for="inputreferenceNo">Reference No</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-7 ">
                                <input class="form-control" type="text" id="inputreferenceNo"
                                       th:field="*{referenceNo}" name="referenceNo"
                                       th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                <input type="hidden"  id="uu" />


                                <span class="help-block" th:if="${#fields.hasErrors('referenceNo')}"
                                      th:errors="*{referenceNo}">referenceNo Error</span>
                            </div>
                            <div class="col-sm-1 ">
                            </div>
                        </div>


                        <div class="form-group ">
                            <input type="hidden" class="form-control" id="inputcolumn" placeholder="column"
                                   th:field="*{column.createdBy}" name="column"/>
                                <span class="help-block" th:if="${#fields.hasErrors('column.createdBy')}"
                                      th:errors="*{column.createdBy}">User Name Error</span>
                        </div>

                        <div class="form-group">
                            <input type="hidden" class="form-control" id="inputcolumnDate" placeholder="columnDate"
                                   th:field="*{column.creationDate}" name="columnDate"/>
                                <span class="help-block" th:if="${#fields.hasErrors('column.creationDate')}"
                                      th:errors="*{column.creationDate}">User Name Error</span>
                        </div>


                        <div>
                        </div>
                       <div>
                           <button type="button" data-toggle="modal" data-target="#modal-RecordHistory" th:id="btnIdHM"
                                   th:attr="data-target='#modal-RecordHistory'"  title="Record History" >
                               <span class="glyphicon glyphicon-record"></span>
                           </button>
                           <script th:inline="javascript">
                               document.getElementById('btnIdHM').onclick = function () {
                                           var obj = [[${glHeader.column}]];
                                           histabledataset(obj);
                                       };

                           </script>

                       </div>
                       <div data-th-replace="fragments/recordHistoryModal :: recordhis-modal"></div>


                        <div class="form-group  col-sm-12 text-right Padding10px" style="padding-right: 92px !important;" >
                            <button type="submit" name="top" class="btn btn-primary">
                                Top
                            </button>

                            <a th:href="@{/AccGL/AddGlHeader/E/}+${pageId}+'/'+${temltId}"
                               class="btn btn-default">New</a>
                            <button type="submit" name="save" class="btn btn-primary"
                                    th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).N)} and ${ADD} "
                                    id="btSave">
                                    <!--onclick="return prevDbClick(this.id)" >-->
                                Save
                            </button>
                            <button type="submit" name="reverse" class="btn btn-danger"
                                    th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P) and !glHeader.revarsedFlage} ">
                                Reverse
                            </button>

                            <a th:href="@{/AccGL/search/E/}+${pageId}+'/'+${temltId}+'/'+${orgHierarchy.id}"
                               class="btn btn-default">Search</a>
                            <button type="submit" th:name="post" class="btn btn-primary postbtn" align="right"
                                   id="postbtn" th:if=" ${POST} and ${glHeader.documentNumber!=null} "
                                    onclick="return prevDbClick(this.id)">
                                Post
                            </button>

                            <button type="submit" name="last" class="btn btn-primary">Last</button>
                            <button type="submit" th:value="${pid}+1" name="Next" class="btn btn-primary">Next</button>
                            <button type="submit" th:value="${pid}-1" name="Privious" class="btn btn-primary">Privious</button>

                        </div>


                        <form class="form-horizontal">
                            <div class=" col-sm-12  dist_view"
                                 th:if="${(glHeader.documentNumber)!=null}">


                                <div class="col-sm-12 brder accgl-col">
                                    <div class="col-sm-1 accgl-col brderright" style="width: 20px">Id</div>
                                    <div class="col-sm-3 accgl-col brderright" align="center">Combinations</div>
                                    <div class="col-sm-2 accgl-col brderright" align="center">DR</div>
                                    <div class="col-sm-2 accgl-col brderright " align="center">CR</div>
                                    <div class="col-sm-4 accgl-col brderright" align="center">Note</div>
                                    <div class="col-sm-1 accgl-col " align="center" style="width: 50px">Action</div>

                                </div>
                                <div class="col-sm-12 accgl-col brder " th:each="GlLines,rowStat  : *{glLinesList}">

                                    <div class="col-sm-1  accgl-col high_control top_marg brderright"
                                         th:text="${rowStat.count}" style="width: 20px">1
                                    </div>

                                    <div class="col-sm-2   accgl-col top_marg brderrightaccgl">


                                        <input class="td form-control " th:type="text" required="required" style="width: 125% !important;"
                                               th:field="*{glLinesList[__${rowStat.index}__].accCodeCombinitionsV.concatedSegment}"
                                               th:id="val+${rowStat.index}"
                                               th:title="(*{glLinesList[__${rowStat.index}__].accCodeCombinitionsV} ?
                                                *{glLinesList[__${rowStat.index}__].accCodeCombinitionsV.concatedSegmentDesc}:'')"
                                               height="2"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                        <input type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].accCodeCombinitions}"
                                               th:value="accCodeCombinitions.id" required="required"
                                               th:id="id+${rowStat.index}"/>
                                        <input type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].accCodeCombinitions.accountSource}"
                                               th:value="accCodeCombinitions" required="required"
                                               th:id="idl+${rowStat.index}"/>

                                        <input type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].sourceTypeNoneTypeVal}"
                                               th:value="sourceTypeNoneTypeVal"
                                               th:id="sAsNtVal+${rowStat.index}"/>


                                        <input class="form-control combatLineId" th:type="hidden" id="pLineId"
                                               th:field="*{glLinesList[__${rowStat.index}__].id}"
                                               th:value="id"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].glHeader}"
                                               th:value="glHeader.id"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].refName}"
                                               th:value="refName"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].refId}"
                                               th:value="refId"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].source}"
                                               th:id="source+${rowStat.index}"
                                               th:value="source"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].accountType}"
                                               th:value="accountType"/>

                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].excgangeRate}"
                                               th:value="excgangeRate"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].excDate}"
                                               th:value="excDate"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].column.createdBy}"
                                               th:value="excDate"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].column.creationDate}"
                                               th:value="excDate"/>
                                    </div>
                                    <div  class="col-sm-1   accgl-col top_marg brderright" style="text-align: right;" >

                                        <button th:disabled="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}" type="button" data-toggle="modal" th:id="${rowStat.index}" data-target="#modal-warning"
                                                th:attr="data-target='#modal-warning'" class="clickMe" data-id="source" >
                                            <span class="glyphicon">&#xe164;</span>
                                        </button>

                                        <script th:inline="javascript">
                                            var mb = '#'+[[${rowStat.index}]];
                                            $(mb).click(function(){
                                                var lSource1 = document.getElementById('source').value;
                                                var btnidmodal=(this.id);
                                                $(".modal-body #inputaccountSource").val(lSource1);
                                                getmodatbtnid(btnidmodal);
                                            });
                                        </script>
                                    </div>



                                    <div class="col-sm-1 form-group accgl-col top_marg brderright">
                                        <input class="form-control combatdr " th:type="text" align="right_col" th:id="${rowStat.index}"
                                               th:field="*{glLinesList[__${rowStat.index}__].drAmount}"
                                               th:oninput="return totDrAmountGl(this)"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                    </div>


                                    <div class="col-sm-1 form-group accgl-col top_marg brderright">
                                        <input class="form-control " th:type="text" align="right_col" th:id="baseamtdr+${rowStat.index}"
                                               th:field="*{glLinesList[__${rowStat.index}__].baseDrAmount}"
                                               th:readonly="true"/>
                                    </div>


                                    <div class="col-sm-1 form-group accgl-col top_marg brderright">
                                        <input class="form-control combatcr" th:type="text"  th:id="${rowStat.index}"
                                               th:field="*{glLinesList[__${rowStat.index}__].crAmount}"
                                               th:oninput="return totCrAmountGl(this)"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                    </div>

                                    <div class="col-sm-1 form-group accgl-col top_marg brderright">
                                        <input class="form-control " th:type="text" align="right_col" th:id="baseamtcr+${rowStat.index}"
                                               th:field="*{glLinesList[__${rowStat.index}__].baseCrAmount}"
                                               th:readonly="true"/>
                                    </div>

                                    <div class="col-sm-4 form-group accgl-col top_marg brderright">
                                        <input class="form-control" th:type="text"
                                               th:field="*{glLinesList[__${rowStat.index}__].description}"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                    </div>
                                    <div class="col-sm-1 form-group accgl-col " align="center"
                                         style="text-align: center; width: 50px" >
                                        <button class="btn-danger" type="submit" name="removeRow"
                                                th:value="${rowStat.index}" style="font-size: 10px; margin-top: 4px;"
                                                th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).N)}">
                                            Remove

                                        </button>
                                    </div>


                                    <div th:id="${rowStat.index}+'div2'" class="col-sm-12 accgl-col"
                                         style="padding-top: 0px;"> <!---2ndLine-->

                                        <div class="col-sm-1  accgl-col high_control top_marg brderright "
                                             th:text="${rowStat.index}" style="width: 18px; color: transparent; "></div>

                                        <div class="col-sm-5   accgl-col top_marg brderright brderright2nddiv">


                                            <input class="td form-control " th:type="text"
                                                   th:field="*{glLinesList[__${rowStat.index}__].sourceName}"
                                                   th:id="sourceName+${rowStat.index}"
                                                   height="2"
                                                   th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                            <input type="hidden" class="inputsourceid"
                                                   th:field="*{glLinesList[__${rowStat.index}__].sourceId}"
                                                   th:value="sourceId"
                                                   th:id="sourceId+${rowStat.index}"/>

                                        </div>
                                        <div class="col-sm-6 form-group accgl-col top_marg brderright brderright2nddiv brderright2nddiv2px">
                                            <input class="form-control " th:type="text" align="right_col"/>
                                        </div>

                                    </div>
                                    <div th:id="${rowStat.index}+'div3'" class="col-sm-12 accgl-col"
                                         style="padding-top: 0px;"> <!---2ndLine-->

                                        <div class="col-sm-1  accgl-col high_control top_marg brderright "
                                             th:text="${rowStat.index}" style="width: 18px; color: transparent; "></div>

                                        <div class="col-sm-5   accgl-col top_marg brderright brderright2nddiv">


                                            <input class="td form-control " th:type="text"
                                                   th:field="*{glLinesList[__${rowStat.index}__].subAccSourceName}"
                                                   th:id="sAsName+${rowStat.index}"
                                                   height="2"
                                                   th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                            <input type="hidden"
                                                   th:field="*{glLinesList[__${rowStat.index}__].subAccSourceId}"
                                                   th:value="subAccSourceId"
                                                   th:id="sAsid+${rowStat.index}"/>

                                            <input type="hidden"
                                                   th:field="*{glLinesList[__${rowStat.index}__].subAccSource}"
                                                   th:value="subAccSource"
                                                   th:id="sAs+${rowStat.index}"/>


                                            <input type="hidden"
                                                   th:field="*{glLinesList[__${rowStat.index}__].dataSet}"
                                                   th:value="dataSet"
                                                   th:id="dataSet+${rowStat.index}"/>


                                        </div>
                                        <div class="col-sm-6 form-group accgl-col top_marg brderright brderright2nddiv brderright2nddiv2px">
                                            <input class="form-control " th:type="text" align="right_col"/>
                                        </div>

                                    </div>

                                    <script th:inline="javascript">
//                                        alert('x'+[[${rowStat.index}]]);


                                        document.getElementById('val' +[[${rowStat.index}]]).oninput = function () {

                                            var lId=[[${rowStat.index}]];
                                            var l_accId = 'val' +lId;

                                            validate(document.getElementById(l_accId).value, l_accId, lId);
                                            document.getElementById(l_accId).focus();
                                        };
                                    </script>

                                    <script th:inline="javascript">
                                        var ssdd='val' +[[${rowStat.index}]];
//                                        alert(ssdd);
                                        var vmode = [[${mode}]];

                                        $(document).ready(function() {
                                            var lfieldindex=[[${rowStat.index}]];
                                            fieldvisivlity(lfieldindex);
                                        });

                                        document.getElementById([['sAsName' +${rowStat.index}]]).oninput = function () {
                                                var psId=[[${rowStat.index}]];

                                                getSubaccSource(psId);
                                            };

                                            document.getElementById([['sourceName' +${rowStat.index}]]).oninput = function () {
                                                var psId=[[${rowStat.index}]];

                                                getSource(psId);
                                            };
                                    </script>


                                </div>
                                <div class="col-sm-12 accgl-col brder ">
                                    <div class="col-sm-1 accgl-col " style="width: 20px"></div>
                                    <div class="col-sm-3 accgl-col brderright"><b>Total</b></div>
                                    <div class="col-sm-2 accgl-col brderright total-combatdr" style="padding-left: 10px !important;"></div>
                                    <div class="col-sm-2 accgl-col brderright total-combatcr"></div>
                                    <div class="col-sm-3 accgl-col isBalanced"></div>
                                    <div class="col-sm-1 accgl-col " align="center"></div>
                                </div>

                                <div class="col-sm-12 brder btn_padd" align="right"
                                     th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).N)}">
                                    <button type="submit" th:name="addRow" class="btn btn-primary ">Add Row
                                    </button>
                                    <button type="submit" name="saveDetail" class="btn btn-success"
                                            id="btDetSave" onclick="return multipleFuncCall(this.id)" align="right">Save Lines
                                    </button>

                                </div>

                                <!--mmm-->
                                <script>
                                    $(document).ready(function () {
                                        glPostBtnVsblty();
                                    });

                                    $(document).ready(function () {
                                        totDrAmountGlM();
                                    });

                                    $(document).ready(function () {
                                        totCrAmountGlM();
                                    });




                                </script>



                            </div>


                        </form>
                        <div>

                            <div th:if="${(glHeader.documentNumber)==null}">
                                <!--<span th:text="nop"></span>-->

                            </div>

                        </div>


                    </form>

                    <div data-th-replace="fragments/accModalData :: account-modal"></div>

                </div>
                <div class="panel-footer">
                </div>
            </div>
            <!--</div>-->
        </div>
    </div>
</div>
<!--/*/ <th:block th:include="fragments/js :: body"></th:block> /*/-->
<script src="../static/js/app.js" th:src="@{/js/app.js}"></script>
</body>
</html>
