<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      lang="en"
      layout:decorator="fragments/layout">
<head>
    <link th:insert="Account/AccScriptLink"/>
    <!--<link th:href="@{/css/easyAutocomplete/easy-autocomplete.min.css}" rel="stylesheet"/>-->

    <!--<script th:src="@{/js/easyAutocomplete/autocomplete.js}"></script>-->
    <!--<script th:src="@{/js/easyAutocomplete/jquery.easy-autocomplete.min.js}"></script>-->
    <script>

        function selectedobj(value, ind) {
            if (ind == 'codecombination') {
                //alert('m');

                sourcedobj(value);
            }
            else if (ind == 'source') {
                //alert('O');
                sourcedobjSource(value);
                // alert('O'+value);
            }


        }
        ;


    </script>

</head>
<body>
<div class="right_col" role="main" data-layout-fragment="content">
    <div class="row">
        <div class="col-sm-8 col-sm-offset-2">
            <!--<div class="container">-->
            <div class="panel panel-default">
                <!-- Default panel contents -->
                <div class="form-group col-sm-12  jepg_cust_head">
                    <div class="form-group col-sm-5 " style="padding-left: 0; color: #172D44">Journal Entry</div>
                    <div class="form-group col-sm-7 text-right Padding10px" style=" font-size: 12px;" align="right">
                        <form th:action="@{'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}}"
                              th:method="post" th:target="_blank"
                              th:if="${glHeader.status!=T(com.aye.web.model.common.GlStatus).N}">
                            <button target="_blank" type="submit" name="rpt"
                                    th:value="'Journal_voucher :'+${glHeader.id}" class="btn btn-primary"
                                    align="center">
                                <span class="glyphicon glyphicon-print"></span> Print

                            </button>
                            <!--<a   th:href="@{/AccGL/AddGlHeader/U/}+${pageId}+'/'+${temltId}"  target="_blank" type="submit" name="rpt" th:value="'Journal_voucher :'+${glHeader.id}" class="btn btn-primary" align="center">Print Voucher</a>-->
                        </form>
                    </div>
                </div>
                <div class="panel-body">
                    <!--<form th:action="@{'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}}"-->
                    <!--th:method="post" th:target="_blank"-->
                    <!--th:if="${glHeader.status!=T(com.aye.web.model.common.GlStatus).N}">-->
                    <!--<button target="_blank" type="submit" name="rpt" th:value="'Journal_voucher :'+${glHeader.id}" class="btn btn-primary" align="center">Print Voucher</button>-->
                    <!--&lt;!&ndash;<a   th:href="@{/AccGL/AddGlHeader/U/}+${pageId}+'/'+${temltId}"  target="_blank" type="submit" name="rpt" th:value="'Journal_voucher :'+${glHeader.id}" class="btn btn-primary" align="center">Print Voucher</a>&ndash;&gt;-->
                    <!--</form>-->
                    <form action="'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}"
                          th:action="@{'/AccGL/AddGlHeader/'+${mode}+'/'+${pageId}+'/'+${temltId}}"
                          th:object="${glHeader}" th:method="post">
                        <!--<button type="submit" name="rpt" th:value="Journal_voucher" class="btn btn-primary">Voucher</button>-->

                        <!--<span style="color: #ed1c24;font-weight: bold" th:each="m :${msg}"><p-->
                        <!--th:text="${m.tag+' '+m.msg}"></p></span>-->

                        <span style="font-weight: bold" th:each="m :${msg}">
                            <p th:style="${m.tag} ? 'color:#ed1c24;':'color:#4aa509;'">
                                <span th:if="${m.tag==null}" th:text="${m.msg}"> </span>
                                <span th:unless="${m.tag==null}" th:text="${m.tag+' '+m.msg}"></span>
                            </p></span>
                        <div class="form-group">
                            <!--<label for="inputSegment1">Name</label>-->
                            <input type="hidden" class="form-control" id="inputid" placeholder="id"
                                   th:field="*{id}" name="id"/>
                            <span class="help-block" th:if="${#fields.hasErrors('id')}"
                                  th:errors="*{id}">Name Error</span>
                        </div>


                        <div class="form-group col-sm-12">

                            <label class="col-sm-3 control-label " for="inputdocumentNumber">Document Number</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-5 ">
                                <input class="form-control" type="text" id="inputdocumentNumber"
                                       th:field="*{documentNumber}" name="documentNumber" readonly="readonly"/>
                                <span class="help-block" th:if="${#fields.hasErrors('documentNumber')}"
                                      th:errors="*{documentNumber}">Name Error</span>
                            </div>

                            <div class="col-sm-3 ">
                                <input class="form-control" type="hidden" id="inputstatus"
                                       th:value="*{status}" th:field="*{status}" name="status"/>
                                <span class="help-block" th:if="${#fields.hasErrors('status')}"
                                      th:errors="*{status}">Status Error</span>
                            </div>

                            <div class="col-sm-3 ">
                                <input class="form-control" type="text" id="inputstatusDesc"
                                       th:field="${glHeader.status.displayName}" readonly="readonly"/>
                                <span class="help-block" th:if="${#fields.hasErrors('status')}"
                                      th:errors="*{status}">Status Error</span>
                            </div>

                        </div>

                        <div class="form-group required col-sm-12">

                            <label class="col-sm-3 control-label " for="inputcategory">Category</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>

                            <div class="col-sm-8 ">
                                <select class="form-control" required="required" type="text" id="inputcategory"
                                        th:field="*{category}" name="category"
                                        th:disabled="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}">
                                    <option th:if="${#lists.size(glCategories) gt 1 }" value="">Please select One
                                    </option>
                                    <option th:each="catagories : ${glCategories}"
                                            th:text="${catagories.categoriesCode}"
                                            th:value="${catagories.id}"
                                            th:attr="data-source=${catagories.accountSource}">module
                                    </option>
                                </select>

                                <div>
                                    <input type="hidden" id="source"
                                           th:field="*{category.accountSource}"
                                           class="form-control"/>
                                </div>
                                <span class="help-block" th:if="${#fields.hasErrors('category')}"
                                      th:errors="*{category}">Category Error</span>
                            </div>
                            <script th:inline="javascript">
                                $("#inputcategory").change(function () {
                                    var varSource = ($(this.options[this.selectedIndex]).attr('data-source'));
                                    $("#source").val(varSource);
//                                    alert(varSource);
                                });
                            </script>
                        </div>


                        <div class="form-group required col-sm-12">
                            <label class="col-sm-3 control-label " for="inputcurrency">Currency</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-8 ">
                                <select class="form-control" name="currency" id="inputcurrency"
                                        th:disabled="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}">
                                    <!--<option value="">Please select One</option>-->
                                    <option th:each="cur : ${currency}" th:value="${cur.id}" th:text="${cur.code}"
                                            th:field="*{currency}"
                                            >
                                    </option>
                                </select>

                                <span class="help-block" th:if="${#fields.hasErrors('currency')}"
                                      th:errors="*{currency}">Currency Error</span>
                            </div>


                        </div>

                        <div class="form-group required col-sm-12">
                            <label class="col-sm-3 control-label " for="inputcalendarDetail">Calendar</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>

                            <div class="col-sm-4  ">
                                <input class="form-control" type="date" value="01-01-2019" id="inputdate"
                                       th:field="*{{date}}"
                                       name="date"
                                       th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                <input type="hidden" id="modelAttr" name="modelAttr" th:value="${temltId}"/>


                                <script>

                                    $("#inputdate").change(function () {
                                        var date = $('#inputdate').val();
                                        $("#inputperiodName").val(moment(date).format('MMM-YY'));
                                    });

                                    $("#inputdate").ready(function () {
                                        var date = $('#inputdate').val();
                                        if (date != "") {
                                            $("#inputperiodName").val(moment(date).format('MMM-YY'));
                                        }
                                    });

                                </script>




                                <span class="help-block" th:if="${#fields.hasErrors('date')}"
                                      th:errors="*{date}">Date Error</span>
                            </div>

                            <div class="col-sm-4  ">
                                <input class="form-control" type="text" name="periodName" id="inputperiodName"
                                       th:field="*{periodName}" readonly="readonly"/>
                                <!--<input class="form-control" type="text" name="calendarDetail" id="inputcalendarDetail"-->
                                <!--th:field="*{calendarDetail}"/>-->
                                <!--  <select class="form-control" name="calendarDetail" id="inputcalendarDetail"
                                  th:field="*{calendarDetail}">
                                  <option value="">Please select One</option>
                                  <option th:each="caldt : ${calendarHeader.calendarDetails}" th:text="${caldt.periodName}"
                                  th:value="${caldt.id}">module
                                  </option>
                                  </select>-->
                                <span class="help-block" th:if="${#fields.hasErrors('periodName')}"
                                      th:errors="*{periodName}">CalendarDetail Error</span>
                            </div>


                            <!--th:each="cal : ${calendarHeader.calendarDetails}"-->
                            <div class="col-sm-4  ">
                                <input class="form-control" type="hidden" name="calendarDetail" id="inputcalendarDetail"
                                       th:field="*{calendarDetail}"/>

                                <span class="help-block" th:if="${#fields.hasErrors('calendarDetail')}"
                                      th:errors="*{calendarDetail}">CalendarDetail Error</span>
                            </div>
                        </div>


                        <div>

                            <div>
                                <input type="hidden" name="appModule" id="appModule"
                                       th:value="${module.id}"/>
                                <span class="help-block" th:if="${#fields.hasErrors('appModule')}"
                                      th:errors="*{appModule}">appModule Error</span>
                            </div>
                        </div>

                        <div>

                            <div>
                                <input type="hidden" name="orgHierarchy" id="orgHierarchy"
                                       th:value="${orgHierarchy.id}"/>
                                <span class="help-block" th:if="${#fields.hasErrors('orgHierarchy')}"
                                      th:errors="*{orgHierarchy}">appModule Error</span>
                            </div>
                        </div>

                        <!--<div class="form-group required col-sm-12">-->
                        <!--<label class="col-sm-3 control-label " for="inputstatus">Status</label>-->

                        <!--<div class="col-sm-1 ">-->
                        <!--<b>:</b>-->
                        <!--</div>-->
                        <!--<div class="col-sm-8 ">-->
                        <!--<input class="form-control" required="required" type="text" id="inputstatus"-->
                        <!--th:field="*{status}" name="status" readonly="readonly"/>-->
                        <!--<span class="help-block" th:if="${#fields.hasErrors('status')}"-->
                        <!--th:errors="*{status}">Status Error</span>-->
                        <!--</div>-->
                        <!--</div>-->

                        <div class="form-group col-sm-12">
                            <label class="col-sm-3 control-label " for="inputdescription">Description</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-8 ">
                                <input class="form-control" type="text" id="inputdescription"
                                       th:field="*{description}" name="description"
                                       th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                <span class="help-block" th:if="${#fields.hasErrors('description')}"
                                      th:errors="*{description}">description Error</span>
                            </div>
                        </div>

                        <div class="form-group col-sm-12">
                            <label class="col-sm-3 control-label " for="inputreferenceNo">Reference No</label>

                            <div class="col-sm-1 ">
                                <b>:</b>
                            </div>
                            <div class="col-sm-8 ">
                                <input class="form-control" type="text" id="inputreferenceNo"
                                       th:field="*{referenceNo}" name="referenceNo"
                                       th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                <span class="help-block" th:if="${#fields.hasErrors('referenceNo')}"
                                      th:errors="*{referenceNo}">referenceNo Error</span>
                            </div>
                        </div>


                        <div class="form-group ">
                            <!--<label for="inputid">Name</label>-->
                            <input type="hidden" class="form-control" id="inputcolumn" placeholder="column"
                                   th:field="*{column.createdBy}" name="column"/>
                            <!--<input type="text" class="form-control" id="inputinvtrnsName" placeholder="Inv Trns Name" th:field="*{transactionName}" name="transactionName"/>-->
                                <span class="help-block" th:if="${#fields.hasErrors('column.createdBy')}"
                                      th:errors="*{column.createdBy}">User Name Error</span>
                        </div>

                        <div class="form-group">
                            <!--<label for="inputid">Name</label>-->
                            <input type="hidden" class="form-control" id="inputcolumnDate" placeholder="columnDate"
                                   th:field="*{column.creationDate}" name="columnDate"/>
                            <!--<input type="text" class="form-control" id="inputinvtrnsName" placeholder="Inv Trns Name" th:field="*{transactionName}" name="transactionName"/>-->
                                <span class="help-block" th:if="${#fields.hasErrors('column.creationDate')}"
                                      th:errors="*{column.creationDate}">User Name Error</span>
                        </div>


                        <div>
                            <!--<input th:type="text"  th:attr="${x}" />-->
                        </div>


                        <div class="form-group  col-sm-12 text-right Padding10px">
                            <button type="submit" name="top" class="btn btn-primary">
                                Top
                            </button>

                            <a th:href="@{/AccGL/AddGlHeader/E/}+${pageId}+'/'+${temltId}"
                               class="btn btn-default">New</a>
                            <button type="submit" name="save" class="btn btn-primary"
                                    th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).N)} and ${ADD} ">
                                Save
                            </button>

                            <a th:href="@{/AccGL/searchGlHeader/E/}+${pageId}+'/'+${temltId}+'/'+${orgHierarchy.id}"
                               class="btn btn-default">Search</a>
                            <button type="submit" name="last" class="btn btn-primary">Last</button>
                            <button type="submit" th:value="${pid}+1" name="Next" class="btn btn-primary">Next</button>
                            <button type="submit" th:value="${pid}-1" name="Privious" class="btn btn-primary">Privious</button>

                        </div>


                        <!--<form th:action="@{'/AccGL/AddLine/'+${mode}+'/'+${pageId}+'/'+${temltId}+'/'+${glHeader.id}}"-->
                        <!--th:object="${glHeader}" action="post">-->
                        <form class="form-horizontal">
                            <div class=" col-sm-12  dist_view"
                                 th:if="${(glHeader.documentNumber)!=null}">


                                <div class="col-sm-12 brder accgl-col">
                                    <div class="col-sm-1 accgl-col brderright" style="width: 20px">Id</div>
                                    <div class="col-sm-3 accgl-col brderright" align="center">Combinations</div>
                                    <div class="col-sm-2 accgl-col brderright" align="center">DR</div>
                                    <div class="col-sm-2 accgl-col brderright " align="center">CR</div>
                                    <div class="col-sm-3 accgl-col brderright" align="center">Note</div>
                                    <div class="col-sm-1 accgl-col " align="center">Action</div>

                                </div>
                                <div class="col-sm-12 accgl-col brder " th:each="GlLines,rowStat  : *{glLinesList}">

                                    <div class="col-sm-1  accgl-col high_control top_marg brderright"
                                         th:text="${rowStat.count}" style="width: 20px">1
                                    </div>

                                    <div class="col-sm-3   accgl-col top_marg brderright">


                                        <input class="td form-control " th:type="text" required="required"
                                               th:field="*{glLinesList[__${rowStat.index}__].accCodeCombinitionsV.concatedSegment}"
                                               th:id="val+${rowStat.count}"
                                               th:title="(*{glLinesList[__${rowStat.index}__].accCodeCombinitionsV} ?
                                                *{glLinesList[__${rowStat.index}__].accCodeCombinitionsV.concatedSegmentDesc}:'')"
                                               height="2"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                        <input type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].accCodeCombinitions}"
                                               th:value="accCodeCombinitions.id" required="required"
                                               th:id="id+${rowStat.count}"/>
                                        <input type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].accCodeCombinitions.accountSource}"
                                               th:value="accCodeCombinitions" required="required"
                                               th:id="id1+${rowStat.count}"/>

                                        <input class="form-control " th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].id}"
                                               th:value="id"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].glHeader}"
                                               th:value="glHeader.id"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].source}"
                                               th:value="source"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].accountType}"
                                               th:value="accountType"/>

                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].excgangeRate}"
                                               th:value="excgangeRate"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].excDate}"
                                               th:value="excDate"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].column.createdBy}"
                                               th:value="excDate"/>
                                        <input th:type="hidden"
                                               th:field="*{glLinesList[__${rowStat.index}__].column.creationDate}"
                                               th:value="excDate"/>


                                    </div>

                                    <div class="col-sm-2 form-group accgl-col top_marg brderright">
                                        <input class="form-control " th:type="text" align="right_col"
                                               th:field="*{glLinesList[__${rowStat.index}__].drAmount}"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                    </div>


                                    <div class="col-sm-2 form-group accgl-col top_marg brderright">
                                        <input class="form-control" th:type="text"
                                               th:field="*{glLinesList[__${rowStat.index}__].crAmount}"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                    </div>
                                    <div class="col-sm-3 form-group accgl-col top_marg brderright">
                                        <input class="form-control" th:type="text"
                                               th:field="*{glLinesList[__${rowStat.index}__].description}"
                                               th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>
                                    </div>
                                    <div class="col-sm-1 form-group accgl-col " align="center"
                                         style="text-align: center ">
                                        <button class="btn-danger" type="submit" name="removeRow"
                                                th:value="${rowStat.index}" style="font-size: 10px; margin-top: 4px;"
                                                th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).N)}">
                                            Remove

                                        </button>
                                    </div>


                                    <div th:id="${rowStat.count}+'div2'" class="col-sm-12 accgl-col"
                                         style="padding-top: 0px;"> <!---2ndLine-->

                                        <div class="col-sm-1  accgl-col high_control top_marg brderright "
                                             th:text="${rowStat.count}" style="width: 18px; color: transparent; "></div>

                                        <div class="col-sm-3   accgl-col top_marg brderright brderright2nddiv">


                                            <input class="td form-control " th:type="text"
                                                   th:field="*{glLinesList[__${rowStat.index}__].sourceName}"
                                                   th:id="val2+${rowStat.count}"
                                                   height="2"
                                                   th:readonly="${(glHeader.status == T(com.aye.web.model.common.GlStatus).P)}"/>

                                            <input type="hidden"
                                                   th:field="*{glLinesList[__${rowStat.index}__].sourceId}"
                                                   th:value="sourceId"
                                                   th:id="id2+${rowStat.count}"/>


                                        </div>
                                        <div class="col-sm-7 form-group accgl-col top_marg brderright brderright2nddiv brderright2nddiv2px">
                                            <input class="form-control " th:type="text" align="right_col"/>
                                        </div>

                                    </div>


                                    <script th:inline="javascript">


                                        function sourcedobj(objparms) {
                                            // alert('A');
                                            var objparmV = objparms;
                                            var dbfield = '#id' + [[${rowStat.count}]];
                                            var dbfield1 = '#id1' + [[${rowStat.count}]];
                                            $(dbfield).val(objparmV.id).trigger("change");
                                            $(dbfield1).val(objparmV.source).trigger("change");


                                        }
                                        ;

                                        var l_accId = 'val' + [[${rowStat.count}]];
                                        document.getElementById(l_accId).oninput = function () {

                                            validate(document.getElementById(l_accId).value, l_accId);
                                            document.getElementById(l_accId).focus();
                                        };

                                        function validate(pAccDesc, pl_accId) {
                                            var lSource = document.getElementById('source').value;
//                                            var org = [[${orgHierarchy.segmentLine.code}]];
                                            var keySegId = [[${orgHierarchy.keySegmentHeader.id}]];

                                            var urlvals;
                                            var getvalues;
                                            var ltemplate = 'ccCode';

                                            var re = /^[A-Za-z]+$/;
                                            if (pAccDesc.length > 1) {
//                                                alert(pAccDesc);

                                                if (re.test(pAccDesc)) {
//                                                    urlvals='/AYE/ACRC/SearchCodeCombDescSourceNot/' + org+'/'+lSource;
                                                    urlvals = '/AYE/ACRC/SearchCodeCombDescBySource/' + pAccDesc + '/' + keySegId + '/'+lSource+ '/'+1;
                                                    getvalues = 'ccDesc';
//                                                    ltemplate ='concatedSegment';
//                                                    alert(urlvals);

                                                }

                                                else {
//                                                alert('Invalid Name.');
//                                                    urlvals='/AYE/ACRC/SearchCodeCombSourceNot/' + org+'/'+lSource;
                                                    urlvals = '/AYE/ACRC/SearchCodeCombBySource/' + pAccDesc + '/' + keySegId + '/'+lSource+ '/'+0;
//                                                    alert(urlvals);
                                                    getvalues = 'ccDesc';
//                                                    ltemplate ='concatedSegment';
                                                }
                                                AutoComAcc(urlvals, getvalues, ltemplate);

                                            }
                                        }

                                        function AutoComAcc(pUrl, pgetvalues, ptemplates) {
//                                            alert(pUrl);
                                            var accDesc = [[${accDesc}]];

                                            var urlvals = pUrl;
//                                       alert(urlvals);
                                            var displayfields = '#val' + [[${rowStat.count}]];
                                            var dbfield = '#id' + [[${rowStat.count}]];
                                            // var dbfield1 = '#id1' + [[${rowStat.count}]];
//                                            var getvalues ='concatedSegment';
                                            var getvalues = pgetvalues;
//                                            var templates='concatedSegment';
                                            var templates = ptemplates;
                                            //alert(templates);
                                            var indc = 'codecombination';

                                            autocomwithobject(urlvals, getvalues, displayfields, dbfield, templates, indc);

                                        }


                                    </script>

                                    <script th:inline="javascript">
                                        var vmode = [[${mode}]];

                                        function sourcedobjSource(objparms) {
                                            // alert('A');
                                            var objparmV = objparms;
                                            var dbfield = '#id2' + [[${rowStat.count}]];
                                            //var dbfield1 = '#id1' + [[${rowStat.count}]];
                                            $(dbfield).val(objparmV.id).trigger("change");
                                            // $(dbfield1).val(objparmV.level).trigger("change");
                                        }
                                        ;

                                        if (vmode == 'U' || vmode == 'E') {
                                            //   alert(vmode);
                                            var varSource = document.getElementById('id1' + [[${rowStat.count}]]).value;
                                            var varSourceViv = [[${rowStat.count}]] + 'div2';
                                            if (varSource == 'NONE') {
                                                // alert('1');

                                                document.getElementById(varSourceViv).style.display = 'none';
//
                                            }

                                        }


                                        var displayfield = '#val' + [[${rowStat.count}]];
                                        //alert('ffff'+displayfield);
                                        var test = document.getElementById('val' + [[${rowStat.count}]]).value
                                        //alert('ggg'+test);
                                        //                                        var aaa =document.getElementById(displayfield).value;
                                        //                                        alert('ggg');
                                        var sourcetypefield = '#id1' + [[${rowStat.count}]];
                                        //alert(sourcetypefield);
                                        //var srctype=document.getElementById($(sourcetypefield)).value
                                        //alert(srctype);

                                        if (test == '') {
                                            var svdf = [[${rowStat.count}]] + 'div2';
                                            document.getElementById(svdf).style.display = 'none';
                                        }
                                        $(displayfield).change(function () {

                                            // var sourcFld = [['#val'+${rowStat.count}]];

                                            var varSource = document.getElementById('id1' + [[${rowStat.count}]]).value;
                                            var svdf = [[${rowStat.count}]] + 'div2';
                                            if (varSource == 'NONE') {
                                                document.getElementById(svdf).style.display = 'none';
                                            }
                                            else {
                                                document.getElementById(svdf).style.display = 'block';
                                            }

                                        })


                                        document.getElementById([['val2' +${rowStat.count}]]).oninput = function () {

                                            getSource();
                                        };

                                        function getSource() {
                                            var gval2 = document.getElementById([['val2' +${rowStat.count}]]).value;
//                                            alert('xx');
                                            if (gval2.length > 1) {

                                                sourceAutocom(gval2);
                                                document.getElementById([['val2' +${rowStat.count}]]).focus();
                                            }
                                        }

                                        function sourceAutocom(val2) {
                                            var orgId = [[${orgHierarchy.id}]];
                                            var src = document.getElementById([['id1' +${rowStat.count}]]).value;
//                                            var src= document.getElementById('#source').value;
//                                           alert('asdf'+val2);
                                            var urlval = '/AYE/ACRC/SearchSource/' + src + '/' + orgId + '/' + val2;
//                                             alert('new'+urlval);
                                            var displayfields = '#val2' + [[${rowStat.count}]];
                                            var dbfields = '#id2' + [[${rowStat.count}]];
                                            var getvalues = 'name';
                                            var templates = 'siteAddress';
                                            //alert(templates);
                                            var indc = 'source';

                                            autocomwithobject(urlval, getvalues, displayfields, dbfields, templates, indc);
//                                            alert([['val2' +${rowStat.count}]]);
                                        }

                                    </script>


                                </div>

                                <div class="col-sm-12 brder btn_padd" align="right"
                                     th:if="${(glHeader.status == T(com.aye.web.model.common.GlStatus).N)}">
                                    <button type="submit" th:name="addRow" class="btn btn-primary ">Add Row
                                    </button>
                                    <button type="submit" name="saveDetail" class="btn btn-success"
                                            align="right">Save Lines
                                    </button>
                                    <button type="submit" th:name="post" class="btn btn-primary" align="right"
                                            th:if="${POST}">
                                        Post
                                    </button>


                                </div>


                            </div>
                        </form>
                        <div>

                            <div th:if="${(glHeader.documentNumber)==null}">
                                <!--<span th:text="nop"></span>-->

                            </div>

                        </div>


                    </form>

                </div>
                <div class="panel-footer">
                </div>
            </div>
            <!--</div>-->
        </div>
    </div>
</div>
<!--/*/ <th:block th:include="fragments/js :: body"></th:block> /*/-->
<script src="../static/js/app.js" th:src="@{/js/app.js}"></script>
</body>
</html>
